<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>STRB LTV Monitor - Real-time Loan to Value</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #000 0%, #1a1a1a 100%);
            min-height: 100vh;
            color: #333;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            color: white;
        }

        .header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }

        .card {
            background: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.15);
        }

        .card-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }

        .card-icon {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            font-size: 1.5rem;
            color: white;
        }

        .btc-icon {
            background: linear-gradient(45deg, #F7931A, #FF8C00);
        }

        .usdt-icon {
            background: linear-gradient(45deg, #26A17B, #50AF95);
        }

        .ltv-icon {
            background: linear-gradient(45deg, #667eea, #764ba2);
        }

        .risk-icon {
            background: linear-gradient(45deg, #FF6B6B, #FF8E53);
        }

        .card-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: #fff;
        }

        .card-value {
            font-size: 2.5rem;
            font-weight: 700;
            color: #fff;
            margin: 10px 0;
            display: flex;
            align-items: center;
        }

        .card-subtitle {
            font-size: 0.9rem;
            color: #888;
            margin-bottom: 15px;
        }

        .progress-bar {
            width: 100%;
            height: 10px;
            background: #e0e0e0;
            border-radius: 5px;
            overflow: hidden;
            margin: 15px 0;
        }

        .progress-fill {
            height: 100%;
            transition: all 0.5s ease;
            border-radius: 5px;
        }

        .safe {
            background: linear-gradient(90deg, #4CAF50, #8BC34A);padding: 0px 10px ;border-radius: 50px;
        }

        .warning {
            background: linear-gradient(90deg, #FF9800, #FFC107);
        }

        .danger {
            background: linear-gradient(90deg, #F44336, #FF5722);
        }

        .status-indicator {
            display: inline-flex;
            align-items: center;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
            margin-top: 10px;
        }

        .status-safe {
            background: rgba(76, 175, 80, 0.1);
            color: #4CAF50;
        }

        .status-warning {
            background: rgba(255, 152, 0, 0.1);
            color: #FF9800;
        }

        .status-danger {
            background: rgba(244, 67, 54, 0.1);
            color: #F44336;
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: #F7931A;
            animation: spin 1s ease-in-out infinite;
            margin-left: 10px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .last-updated {
            text-align: center;
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.9rem;
            margin-top: 30px;
        }

        .info-section {
            background: rgba(10, 10, 10, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            margin-top: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }

        .info-section h3 {
            color: #fff;
            margin-bottom: 20px;
            font-size: 1.3rem;
        }

        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .info-item {
            padding: 20px;
            background: #050505;
            border-radius: 15px;
            border-left: 4px solid #333;
        }

        .info-item h4 {
            color: #fff;
            margin-bottom: 10px;
            font-size: 1rem;
        }

        .info-item p {
            color: #666;
            line-height: 1.6;
            font-size: 0.9rem;
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .card {
                padding: 20px;
            }
            
            .card-value {
                font-size: 2rem;
            }
            
            .dashboard {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1><i class="fas fa-chart-line"></i> ALL CAPITAL LTV Monitor</h1>
            <p>Monitoring Loan to Value Ratio secara Real-time</p>
        </div>

        <div class="dashboard">
            <!-- Bitcoin Price Card -->
            <div class="card">
                <div class="card-header">
                    <div class="card-icon btc-icon">
                        <i class="fab fa-bitcoin"></i>
                    </div>
                    <div>
                        <div class="card-title">Harga Bitcoin</div>
                        <div class="card-subtitle">Real-time BTC/USD</div>
                    </div>
                </div>
                <div class="card-value" id="btc-price">
                    $0.00 <span class="loading"></span>
                </div>
            </div>

            <!-- Collateral Value Card -->
            <div class="card">
                <div class="card-header">
                    <div class="card-icon btc-icon">
                        <i class="fas fa-coins"></i>
                    </div>
                    <div>
                        <div class="card-title">Nilai Kolateral</div>
                        <div class="card-subtitle" id="collateral-btc-display"></div>
                    </div>
                </div>
                <div class="card-value" id="collateral-value">
                    $0.00
                </div>
            </div>

            <!-- Loan Amount Card -->
            <div class="card">
                <div class="card-header">
                    <div class="card-icon usdt-icon">
                        <i class="fas fa-dollar-sign"></i>
                    </div>
                    <div>
                        <div class="card-title">Jumlah Pinjaman</div>
                        <div class="card-subtitle" id="loan-usdt-display"></div>
                    </div>
                </div>
                <div class="card-value">
                    $4477.97
                </div>
            </div>

            <!-- LTV Ratio Card -->
            <div class="card">
                <div class="card-header">
                    <div class="card-icon ltv-icon">
                        <i class="fas fa-percentage"></i>
                    </div>
                    <div>
                        <div class="card-title">LTV Ratio</div>
                        <div class="card-subtitle">Loan to Value</div>
                    </div>
                </div>
                <div class="card-value" id="ltv-ratio">
                    0.00%
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="ltv-progress"></div>
                </div>
                <div class="status-indicator" id="ltv-status">
                    <i class="fas fa-circle"></i> Calculating...
                </div>
            </div>

            <!-- Risk Level Card -->
            <div class="card">
                <div class="card-header">
                    <div class="card-icon risk-icon">
                        <i class="fas fa-exclamation-triangle"></i>
                    </div>
                    <div>
                        <div class="card-title">Tingkat Risiko</div>
                        <div class="card-subtitle">Risk Assessment</div>
                    </div>
                </div>
                <div class="card-value" id="risk-level">
                    Calculating...
                </div>
                <div id="liquidation-price" style="font-size: 1rem; color: #666; margin-top: 10px;">
                    Harga Likuidasi: $0.00
                </div>
            </div>

            <!-- Health Factor Card -->
            <div class="card">
                <div class="card-header">
                    <div class="card-icon ltv-icon">
                        <i class="fas fa-heartbeat"></i>
                    </div>
                    <div>
                        <div class="card-title">Health Factor</div>
                        <div class="card-subtitle">Position Health</div>
                    </div>
                </div>
                <div class="card-value" id="health-factor">
                    0.00
                </div>
                <div style="font-size: 0.9rem; color: #666; margin-top: 10px;">
                    Health Factor > 1.0 = Aman
                </div>
            </div>
        </div>

        <div class="info-section">
            <h3><i class="fas fa-info-circle"></i> Informasi STRB</h3>
            <div class="info-grid">
                <div class="info-item">
                    <h4>Kolateral Bitcoin</h4>
                    <p>Jumlah Bitcoin yang dijadikan jaminan dalam protokol DeFi untuk mendapatkan pinjaman USDT.</p>
                </div>
                <div class="info-item">
                    <h4>LTV Maksimum</h4>
                    <p>Batas maksimum LTV adalah 50% untuk menjaga keamanan posisi dan menghindari risiko likuidasi.</p>
                </div>
                <div class="info-item">
                    <h4>Manajemen Risiko</h4>
                    <p>Jika LTV mendekati 50%, dana komunitas Arisanvestasi akan digunakan sebagai backup untuk menambah kolateral.</p>
                </div>
                <div class="info-item">
                    <h4>Update Real-time</h4>
                    <p>Data harga Bitcoin diperbarui setiap 30 detik menggunakan API CoinGecko untuk akurasi tinggi.</p>
                </div>
            </div>
        </div>

        <div class="last-updated">
            <i class="fas fa-clock"></i> Terakhir diperbarui: <span id="last-updated">-</span>
        </div>
    </div>

    <script>
        // STRB Configuration
        const STRB_CONFIG = {
            collateralBTC: 0.083247562, // Edit this value for collateral in BTC
            loanUSDT: 4477.97, // Edit this value for loan in USDT
            maxLTV: 90,
            warningLTV: 60,
            dangerLTV: 75
        };

        // DOM Elements
        const elements = {
            btcPrice: document.getElementById("btc-price"),
            collateralValue: document.getElementById("collateral-value"),
            collateralBTCDisplay: document.getElementById("collateral-btc-display"),
            loanUSDTDisplay: document.getElementById("loan-usdt-display"),
            ltvRatio: document.getElementById("ltv-ratio"),
            ltvProgress: document.getElementById("ltv-progress"),
            ltvStatus: document.getElementById("ltv-status"),
            riskLevel: document.getElementById("risk-level"),
            liquidationPrice: document.getElementById("liquidation-price"),
            healthFactor: document.getElementById("health-factor"),
            lastUpdated: document.getElementById("last-updated")
        };

        // Display initial collateral and loan values
        elements.collateralBTCDisplay.textContent = `${STRB_CONFIG.collateralBTC} BTC`;
        elements.loanUSDTDisplay.textContent = `${STRB_CONFIG.loanUSDT} USDT Borrowed`;

        // Format currency
        function formatCurrency(amount, currency = 'USD') {
            return new Intl.NumberFormat('en-US', {
                style: 'currency',
                currency: currency,
                minimumFractionDigits: 2,
                maximumFractionDigits: 2
            }).format(amount);
        }

        // Format percentage
        function formatPercentage(value) {
            return `${value.toFixed(2)}%`;
        }

        // Get Bitcoin price from CoinGecko API
        async function getBitcoinPrice() {
            try {
                const response = await fetch('https://api.coingecko.com/api/v3/simple/price?ids=bitcoin&vs_currencies=usd&include_24hr_change=true');
                const data = await response.json();
                return {
                    price: data.bitcoin.usd,
                    change24h: data.bitcoin.usd_24h_change
                };
            } catch (error) {
                console.error('Error fetching Bitcoin price:', error);
                return null;
            }
        }

        // Calculate LTV and other metrics
        function calculateMetrics(btcPrice) {
            const collateralValueUSD = STRB_CONFIG.collateralBTC * btcPrice;
            const ltvRatio = (STRB_CONFIG.loanUSDT / collateralValueUSD) * 100;
            const healthFactor = collateralValueUSD / STRB_CONFIG.loanUSDT;
            const liquidationPrice = STRB_CONFIG.loanUSDT / (STRB_CONFIG.collateralBTC * (STRB_CONFIG.maxLTV / 100));

            return {
                collateralValueUSD,
                ltvRatio,
                healthFactor,
                liquidationPrice
            };
        }

        // Update LTV status and styling
        function updateLTVStatus(ltvRatio) {
            let statusClass, statusText, statusIcon, progressClass;

            if (ltvRatio < STRB_CONFIG.warningLTV) {
                statusClass = 'status-safe';
                statusText = 'Aman';
                statusIcon = 'fa-check-circle';
                progressClass = 'safe';
            } else if (ltvRatio < STRB_CONFIG.dangerLTV) {
                statusClass = 'status-warning';
                statusText = 'Peringatan';
                statusIcon = 'fa-exclamation-triangle';
                progressClass = 'warning';
            } else {
                statusClass = 'status-danger';
                statusText = 'Bahaya';
                statusIcon = 'fa-exclamation-circle';
                progressClass = 'danger';
            }

            elements.ltvStatus.className = `status-indicator ${statusClass}`;
            elements.ltvStatus.innerHTML = `<i class="fas ${statusIcon}"></i> ${statusText}`;
            
            elements.ltvProgress.className = `progress-fill ${progressClass}`;
            elements.ltvProgress.style.width = `${Math.min(ltvRatio, 100)}%`;
        }

        // Update risk level
        function updateRiskLevel(ltvRatio, healthFactor) {
            let riskText, riskClass;

            if (ltvRatio < STRB_CONFIG.warningLTV) {
                riskText = 'Rendah';
                riskClass = 'safe';
            } else if (ltvRatio < STRB_CONFIG.dangerLTV) {
                riskText = 'Sedang';
                riskClass = 'warning';
            } else {
                riskText = 'Tinggi';
                riskClass = 'danger';
            }

            elements.riskLevel.textContent = riskText;
            elements.riskLevel.className = `card-value ${riskClass}`;
        }

        // Update all data
        async function updateData() {
            try {
                const btcData = await getBitcoinPrice();
                if (!btcData) return;

                const metrics = calculateMetrics(btcData.price);

                // Update Bitcoin price with change indicator
                const changeIcon = btcData.change24h >= 0 ? 'fa-arrow-up' : 'fa-arrow-down';
                const changeColor = btcData.change24h >= 0 ? '#4CAF50' : '#F44336';
                elements.btcPrice.innerHTML = `
                    ${formatCurrency(btcData.price)}
                    <i class="fas ${changeIcon}" style="color: ${changeColor}; font-size: 1rem; margin-left: 10px;"></i>
                `;

                // Update collateral value
                elements.collateralValue.textContent = formatCurrency(metrics.collateralValueUSD);

                // Update LTV ratio
                elements.ltvRatio.textContent = formatPercentage(metrics.ltvRatio);
                updateLTVStatus(metrics.ltvRatio);

                // Update risk level
                updateRiskLevel(metrics.ltvRatio, metrics.healthFactor);

                // Update health factor
                elements.healthFactor.textContent = metrics.healthFactor.toFixed(3);
                if (metrics.healthFactor < 1.2) {
                    elements.healthFactor.style.color = '#F44336';
                    elements.healthFactor.classList.add('pulse');
                } else {
                    elements.healthFactor.style.color = '#4CAF50';
                    elements.healthFactor.classList.remove('pulse');
                }

                // Update liquidation price
                elements.liquidationPrice.textContent = `Harga Likuidasi: ${formatCurrency(metrics.liquidationPrice)}`;

                // Update last updated time
                elements.lastUpdated.textContent = new Date().toLocaleString('id-ID');

            } catch (error) {
                console.error('Error updating data:', error);
            }
        }

        // Initialize and set up auto-refresh
        document.addEventListener('DOMContentLoaded', function() {
            updateData(); // Initial load
            setInterval(updateData, 30000); // Update every 30 seconds
        });

        // Add some visual feedback on card hover
        document.querySelectorAll('.card').forEach(card => {
            card.addEventListener('mouseenter', function() {
                this.style.transform = 'translateY(-8px) scale(1.02)';
            });
            
            card.addEventListener('mouseleave', function() {
                this.style.transform = 'translateY(0) scale(1)';
            });
        });
    </script>
</body>
</html>

